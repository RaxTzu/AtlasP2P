# ===========================================
# ATLASP2P - PRODUCTION ENVIRONMENT
# ===========================================
# Complete production environment template
# Copy this file to production.env and fill in your values
#
# SECURITY WARNING:
#   - NEVER commit production.env to git
#   - Keep all secrets secure (API keys, passwords, tokens)
#   - Use AWS SSM or GitHub Secrets for CI/CD
#
# Setup Scripts:
#   ./scripts/setup-ssm.sh           - Upload to AWS SSM Parameter Store
#   ./scripts/setup-github-secrets.sh - Upload to GitHub Secrets
# ===========================================

# ===========================================
# PROJECT CONFIGURATION
# ===========================================

# Docker Compose project name (controls container/image naming)
# Example: COMPOSE_PROJECT_NAME=mychain (creates mychain-web, mychain-db, etc.)
COMPOSE_PROJECT_NAME=atlasp2p

# ===========================================
# DOMAIN & SSL CONFIGURATION
# ===========================================

# Your production domain (required for SSL)
# Example: DOMAIN=nodes.yourcoin.org
DOMAIN=YOUR_DOMAIN_HERE

# Email for Let's Encrypt SSL certificate notifications
# Example: ACME_EMAIL=admin@yourcoin.org
ACME_EMAIL=YOUR_EMAIL_HERE

# Site URL (must match DOMAIN)
# Example: SITE_URL=https://nodes.yourcoin.org
SITE_URL=https://${DOMAIN}

# API External URL (Supabase endpoint accessible from browser)
# Example: API_EXTERNAL_URL=https://nodes.yourcoin.org/supabase
API_EXTERNAL_URL=https://${DOMAIN}/supabase

# ===========================================
# PORT CONFIGURATION (PRODUCTION)
# ===========================================

# Web application port (internal: 3000, external via reverse proxy)
PORT=3000
WEB_PORT=4000

# Kong API Gateway port (exposed for external reverse proxy)
KONG_PORT=4020

# Database port (only expose if needed for remote access)
DB_PORT=4021

# Studio port (disable in production or use firewall rules)
# STUDIO_PORT=4022

# ===========================================
# DATABASE CONFIGURATION
# ===========================================

# PostgreSQL password (generate with: openssl rand -base64 32)
POSTGRES_PASSWORD=YOUR_STRONG_PASSWORD_HERE

# PostgreSQL database name
POSTGRES_DB=postgres

# ===========================================
# JWT & AUTHENTICATION
# ===========================================

# JWT Secret for Supabase Auth (generate with: openssl rand -hex 32)
# IMPORTANT: Must be at least 32 characters
# Generate: openssl rand -hex 32
JWT_SECRET=YOUR_JWT_SECRET_64_CHARS_MINIMUM_CHANGE_THIS_IN_PRODUCTION

# Supabase Anon Key (generate at: https://supabase.com/docs/guides/auth/server-side/creating-a-client)
# For self-hosted: Use JWT generated with role "anon" and same JWT_SECRET
SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY_HERE

# Supabase Service Role Key (admin access, keep secret!)
# For self-hosted: Use JWT generated with role "service_role" and same JWT_SECRET
SUPABASE_SERVICE_ROLE_KEY=YOUR_SUPABASE_SERVICE_ROLE_KEY_HERE

# Supabase URLs (for client-side, publicly accessible)
NEXT_PUBLIC_SUPABASE_URL=https://${DOMAIN}/supabase
NEXT_PUBLIC_SUPABASE_ANON_KEY=${SUPABASE_ANON_KEY}

# Supabase Internal URL (Docker networking, server-side only)
SUPABASE_URL=http://kong:8000
SUPABASE_INTERNAL_URL=http://kong:8000

# ===========================================
# ADMIN CONFIGURATION
# ===========================================

# Super Admin Emails (comma-separated, permanent access)
# Example: ADMIN_EMAILS=admin@yourcoin.org,owner@yourcoin.org
ADMIN_EMAILS=YOUR_ADMIN_EMAIL_HERE

# ===========================================
# SMTP CONFIGURATION (GoTrue Auth Emails)
# ===========================================
# These settings are for Supabase Auth (GoTrue) emails
# (signup, password reset, email verification)
#
# OPTION 1: Resend SMTP (Recommended)
# Get API key at: https://resend.com/api-keys
# Use SMTP relay for GoTrue compatibility

SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USER=resend
SMTP_PASS=YOUR_RESEND_API_KEY_HERE
SMTP_ADMIN_EMAIL=noreply@yourdomain.com
SMTP_SENDER_NAME=YourProjectName

# OPTION 2: SendGrid SMTP (Alternative)
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USER=apikey
# SMTP_PASS=YOUR_SENDGRID_API_KEY_HERE
# SMTP_ADMIN_EMAIL=noreply@yourdomain.com
# SMTP_SENDER_NAME=YourProjectName

# OPTION 3: Custom SMTP Server
# SMTP_HOST=mail.yourdomain.com
# SMTP_PORT=587
# SMTP_USER=noreply@yourdomain.com
# SMTP_PASS=YOUR_SMTP_PASSWORD_HERE
# SMTP_ADMIN_EMAIL=noreply@yourdomain.com
# SMTP_SENDER_NAME=YourProjectName

# Email verification settings (production)
GOTRUE_MAILER_AUTOCONFIRM=false
GOTRUE_MAILER_EXTERNAL_HOSTS=localhost,kong

# ===========================================
# APPLICATION EMAIL CONFIGURATION
# ===========================================
# These settings are for custom app emails (alerts, notifications)
# Provider is configured in config/project.config.yaml
# Only the API keys go here for security

# Resend HTTP API (recommended - faster, with tracking)
# Get key at: https://resend.com/api-keys
RESEND_API_KEY=YOUR_RESEND_API_KEY_HERE

# SendGrid HTTP API (alternative)
# Get key at: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=YOUR_SENDGRID_API_KEY_HERE

# Custom SMTP (if using 'smtp' provider in config)
# SMTP_USER=your_smtp_username
# SMTP_PASSWORD=your_smtp_password
# SMTP_TLS=true

# ===========================================
# SECURITY - TURNSTILE (CLOUDFLARE)
# ===========================================

# Cloudflare Turnstile for bot protection
# Get keys at: https://dash.cloudflare.com/turnstile
#
# NOTE: Site key and config are in config/project.config.yaml
# Only the SECRET key goes here for security
TURNSTILE_SECRET_KEY=YOUR_TURNSTILE_SECRET_KEY_HERE

# ===========================================
# CRON JOB SECURITY
# ===========================================

# Cron job authentication token (generate with: openssl rand -hex 32)
# Used to secure /api/cron endpoints
# Generate: openssl rand -hex 32
CRON_SECRET=YOUR_CRON_SECRET_64_CHARS_MINIMUM_CHANGE_THIS_IN_PRODUCTION

# ===========================================
# BLOCKCHAIN RPC CONFIGURATION
# ===========================================

# RPC connection to your blockchain node
# For production: Use actual node IP/hostname or localhost if on same server
RPC_HOST=localhost
RPC_PORT=34645
RPC_USER=YOUR_RPC_USERNAME_HERE
RPC_PASS=YOUR_RPC_PASSWORD_HERE

# ===========================================
# GEOIP CONFIGURATION
# ===========================================

# MaxMind GeoLite2 credentials
# Get account at: https://www.maxmind.com/en/geolite2/signup
MAXMIND_ACCOUNT_ID=YOUR_MAXMIND_ACCOUNT_ID_HERE
MAXMIND_LICENSE_KEY=YOUR_MAXMIND_LICENSE_KEY_HERE

# ===========================================
# DOCKER REGISTRY CONFIGURATION (CI/CD)
# ===========================================
# These variables are automatically injected by CI/CD workflow
# You DON'T need to set these manually in production.env
# They're shown here for reference only
#
# The workflow reads registry config from config/project.config.yaml
# and injects these vars before deployment
#
# For GHCR (GitHub Container Registry):
#   REGISTRY_TYPE=ghcr
#   REGISTRY_PUBLIC=true
#   REGISTRY=ghcr.io/your-org
#   IMAGE_PREFIX=atlasp2p-
#   IMAGE_TAG=latest
#
# For ECR (AWS Elastic Container Registry):
#   REGISTRY_TYPE=ecr
#   REGISTRY_PUBLIC=false
#   REGISTRY_REGION=us-east-1
#   REGISTRY=123456789.dkr.ecr.us-east-1.amazonaws.com
#   IMAGE_PREFIX=atlasp2p/
#   IMAGE_TAG=latest

# ===========================================
# OPTIONAL: ANALYTICS & MONITORING
# ===========================================

# Plausible Analytics (if enabled in config/project.config.yaml)
# PLAUSIBLE_DOMAIN=nodes.yourcoin.org

# Google Analytics (if enabled in config/project.config.yaml)
# NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# Matomo Analytics (if enabled in config/project.config.yaml)
# NEXT_PUBLIC_MATOMO_URL=https://matomo.yourdomain.com
# NEXT_PUBLIC_MATOMO_SITE_ID=1

# Fathom Analytics (if enabled in config/project.config.yaml)
# NEXT_PUBLIC_FATHOM_SITE_ID=ABCDEFGH

# ===========================================
# OPTIONAL: ERROR TRACKING
# ===========================================

# Sentry (if enabled in config/project.config.yaml)
# NEXT_PUBLIC_SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx
# SENTRY_AUTH_TOKEN=your_auth_token_here

# ===========================================
# OPTIONAL: STORAGE CONFIGURATION
# ===========================================

# AWS S3 for avatar storage (alternative to local storage)
# S3_BUCKET=atlasp2p-avatars
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=YOUR_ACCESS_KEY_HERE
# S3_SECRET_ACCESS_KEY=YOUR_SECRET_KEY_HERE

# Supabase Storage (if using Supabase Cloud)
# NEXT_PUBLIC_SUPABASE_STORAGE_BUCKET=avatars

# ===========================================
# DEPLOYMENT NOTES
# ===========================================
#
# 1. SECRETS MANAGEMENT:
#    - For AWS SSM: Run ./scripts/setup-ssm.sh
#    - For GitHub Secrets: Run ./scripts/setup-github-secrets.sh
#
# 2. ENVIRONMENT VARIABLE PRIORITY:
#    - CI/CD injects: REGISTRY, IMAGE_PREFIX, IMAGE_TAG (from project.config.yaml)
#    - SSM/Secrets provide: All sensitive variables (this file)
#    - deployment.env provides: NEXT_PUBLIC_* variables (baked at build time)
#
# 3. VALIDATION:
#    - Required variables are validated on server startup
#    - Missing variables will prevent server from starting
#    - Check logs if deployment fails
#
# 4. SECURITY CHECKLIST:
#    ✓ Change all default passwords and secrets
#    ✓ Use strong passwords (minimum 32 characters)
#    ✓ Enable HTTPS with valid SSL certificate
#    ✓ Restrict database port (DB_PORT) via firewall
#    ✓ Disable Supabase Studio in production (remove STUDIO_PORT)
#    ✓ Keep SUPABASE_SERVICE_ROLE_KEY secret (never expose to client)
#    ✓ Use environment-specific SMTP credentials
#    ✓ Enable Turnstile for bot protection
#    ✓ Regularly rotate secrets and API keys
#
# ===========================================
